export default {
  async fetch(request) {
    const url = new URL(request.url)

    // ROOT DOMAIN → homepage streamzu
    if (url.pathname === '/' || url.pathname === '') {
      return Response.redirect(
        'https://www5.filesmoon.site/',
        302
      )
    }

    // /e/{id} → player
    if (url.pathname.startsWith('/e/')) {
      const id = url.pathname.replace('/e/', '')

      const html = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script>
    location.replace('https://www5.filesmoon.site/#/e/${id}')
  </script>
</head>
<body>
  Redirecting...
</body>
</html>`

      return new Response(html, {
        headers: {
          'content-type': 'text/html;charset=UTF-8'
        }
      })
    }

    // path lain → homepage
    return Response.redirect(
      'https://www5.filesmoon.site/',
      302
    )
  }
}
